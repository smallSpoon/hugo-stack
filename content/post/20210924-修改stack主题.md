---
title: "20210924 修改stack主题"
date: 2021-09-24T14:15:04+08:00
toc: true
tags:
  - Hugo
categories:
  - 麻瓜快速念咒互助小组
description: 炸房子是一种生活爱好，一天三次、少量多餐、一二三四、再来一次
series:
draft: true
slug: f9f0ec87
featuredImage:
draft: false

---

## TO-DO 

- [x] 调整文章页面的显示样式，在右侧栏显示搜索、归档和Tags

- [x] 调整首页文章摘要字号

- [x] 调整左侧栏Home链接，使之不打开新页面

- [x] 修改文章字号

- [x] 删除vibrant.js插件

- [x] 解决右侧toc栏消失问题

- [x] 调整相关文章数量

- [x] 使文章中能够使用html

- [x] 为分类配色

- [x] 修改超链接显示

- [ ] 修改About页

- [ ] 增加左侧栏友情链接

- [ ] 加入每篇文章的字数统计

- [ ] 修改Markdown渲染样式（代码框等）

- [ ] 加入代码高亮

  

{{< codehtml >}} 
    <br/>
{{< /codehtml >}}




## 调整文章页面的显示样式
在主题的Issue里找到了[开源的修改](https://github.com/ShadowySpirits/hugo-theme-stack)，套用了一下

套用后发现右侧toc栏消失了，后来发现是没加上toc组件，调整根目录下`config.yaml`

```
    widgets:
        enabled: 
            - search
            - toc
            - archives
            - tag-cloud
```
{{< codehtml >}} 
    <br/>
{{< /codehtml >}}


## 调整字号
### 修改文章字号
修改hugo-theme-stack/assets/scss/variables.scss

```
:root {
    --article-font-family: var(--base-font-family);
    --article-font-size: 1.6rem;

    @include respond(md) {
        --article-font-size: 1.7rem; //改为1.6rem
    }

```
{{< codehtml >}} 
    <br/>
{{< /codehtml >}}

### 修改摘要字号

修改`assets\scss\partials\article.scss`

```
.article-subtitle {
    font-weight: normal;
    color: var(--card-text-color-secondary);
    margin: 5px 0;
    line-height: 1.5;

    font-size: 1.75rem;
    @include respond(xl) {
        font-size: 2rem; //改为1.5rem
    }
}
```
{{< codehtml >}} 
    <br/>
{{< /codehtml >}}

## 调整左侧栏Home链接

调整根目录下`config.yaml`

```
menu:
    main:
        - identifier: home
          name: Home
          url: /
          weight: -100
          pre: home
          params:
              ### For demonstration purpose, the home link will be open in a new tab
              newTab: true //改为false
```

{{< codehtml >}} 
    <br/>
{{< /codehtml >}}

## 删除vibrant.js插件

vibrant.js插件是一个为分类图片加上相似色调滤镜的插件，我用不上，就删了。

步骤上完全按照[Hugo Stack主題修改記錄 (瘦身篇)](https://www.bigs3.com/article/modify-hugo-theme-stack-one/)的步骤进行

另外同样根据这篇文章修改了页面样式

{{< codehtml >}} 
    <br/>
{{< /codehtml >}}

### 删除Categories的特色图片

修改`assets/scss/partials/layout/list.scss`

```
.subsection-list {
    margin-bottom: var(--section-separation);
    overflow-x: auto;

    .article-list--tile {
        display: flex;
        padding-bottom: 15px;

        article {
            width: 200px; //改爲200px
            height: 50px; //改爲50px
            margin-right: 5px; //改爲5px
            flex-shrink: 0;

            .article-title {
                margin: 0;
                font-size: 1.5rem; //改爲1.5rem，調整字體尺寸
            }

            .article-details {
                padding: 20px;
                justify-content: center; //添加justify-content設定，保持字體居中
            }

        }
    }
}
```
{{< codehtml >}} 
    <br/>
{{< /codehtml >}}

### 删除相关文章的特色图片

修改`assets/scss/partials/layout/article.scss`

```
.related-contents {
    overflow-x: auto;
    padding-bottom: 15px;

    & > .flex {
        float: left;
    }

    article {
        margin-right: 15px;
        flex-shrink: 0;
        overflow: hidden;
        width: 250px;
        height: 80px; //改为80

        .article-title {
            font-size: 1.5rem; //改为1.5
            margin: auto;
            justify-content: center; //居中
        }
```
{{< codehtml >}} 
    <br/>
{{< /codehtml >}}


## 调整相关文章数量

修改`layouts/partials/article/components/related-contents.html`

```
 {{ $related := (where (.Site.RegularPages.Related .) "Params.hidden" "!=" true) | first 5 }}  //修改数字即可
```

{{< codehtml >}} 
    <br/>
{{< /codehtml >}}

## 为Markdown增加Html支持

解决办法来源于[Hugo博客中.md文件中嵌入的html代码无法被渲染](https://d.cosx.org/d/421422-hugomdhtml)，在`config.yaml`里加入

```
markup:
  goldmark:
    renderer:
      unsafe: true
```

但是如果这么开启Html，目录就会跟着被渲染成非常难看的无序列表。大部分情况下，Html只被我用来写空白行，因此这牺牲未免太大了一点，所以换成了用Shortcode来解决。

步骤参考[HUGO如何在Markdown上使用HTML | Yayapipi Site](https://yayapipi.com/posts/hugo%E5%A6%82%E4%BD%95%E5%9C%A8markdown%E4%B8%8A%E4%BD%BF%E7%94%A8html/)

在`layout/shortcode/`里新增`codehtml.html`，内容为

```
{{.Inner}}
```

空白行的写法是：

```
## codehtml前后包裹{{ }} 
< codehtml >
  <br/>
< /codehtml >
```

不过这样还有个问题在于，代码块里写HTML，代码不能被屏蔽……暂时找不到好的解决办法，先这样吧。

{{< codehtml >}} 
  <br/>
{{< /codehtml >}}

## 头像与站点描述居中显示

分别是assets\scss\partials\sidebar.scss的以下几个参数

```
	.site-avatar {
        position: relative;
        margin-left:auto; //站点头像居中
		margin-right:auto; //站点头像居中
        width: var(--sidebar-avatar-size);
        height: var(--sidebar-avatar-size);

	.site-name {
        color: var(--accent-color);
        text-align:center; //站点名称居中
        font-size: 1.8rem;

        @include respond(2xl) {
            font-size: 2rem;
        }
    }

	.site-description {
        color: var(--body-text-color);
        font-weight: normal;
        text-align:center; //站点描述居中
        font-size: 1.6rem;

        @include respond(2xl) {
            font-size: 1.8rem;
        }
    }
```

{{< codehtml >}} 
    <br/>
{{< /codehtml >}}

## 修改分类颜色

这个东西众里寻他千百度找不到，结果就在`content\categories`里，像个冷笑话。

在categories文件夹创建分类同名文件夹，创建`_index.md`文件

```
title: "做猫贵在折腾" //分类名称
description: "简介 Blablabla" //不需要可以删了
image: "ffxiv_20210830_230509_817.png" //分类题图，也可以删了
style:
    background: "#80aba9" //分类标签底色
    color: "#fff"
---
```
{{< codehtml >}} 
    <br/>
{{< /codehtml >}}

## 修改超链接显示



```
a {
    text-decoration: none;
    color: var(--accent-color);

    &:hover {
        color: var(--accent-color-darker);
    }

    &.link {  //鼠标未悬停时，超链接显示6px的高亮
        box-shadow: 0px -6px 0px rgba(var(--link-background-color), var(--link-background-opacity-hover)) inset; 
        transition: all 0.3s ease;

        &:hover { //鼠标悬停，高亮为10px
            box-shadow: 0px -10px 0px rgba(var(--link-background-color), var(--link-background-opacity-hover)) inset; 
        }
    }
}
```

{{< codehtml >}} 
    <br/>
{{< /codehtml >}}

## 修改文章标题前提示块

……我也不知道叫它什么比较好，总之是比较喜欢它长一点，修改`assets\scss\variables.scss`

```
    --heading-border-size: 10px; 
```

{{< codehtml >}} 
  <br/>
{{< /codehtml >}}

## 修改Toc样式

原来的目录行间距太宽，超出一定长度还会出现滑块，调整了一下。

```
.widget--toc {
    background-color: var(--card-background);
    border-radius: var(--card-border-radius);
    box-shadow: var(--shadow-l1);
    display: flex;
    flex-direction: column;
    color: var(--card-text-color-main);
    overflow: hidden;

    #TableOfContents {
        overflow-x: auto;
        max-height: 150vh; //控制最长高度，超出则出现滑动条

        ol,
        ul {
            margin: 0;
            padding: 0;
        }

        ol {
            list-style-type: none;
            counter-reset: item;

            li:before {
                counter-increment: item;
                content: counters(item, ".") ". ";
                font-weight: bold;
                margin-right: 5px;
            }
        }

        & > ul {
            padding: 0 1em;
        }

        li {
            margin: 2px 10px; //第一个参数是行间距，第二个是卡片周边的宽度
            padding: 8px; //控制内边距

            & > ol,
            & > ul {
                margin-top: 10px;
                padding-left: 10px;
                margin-bottom: -5px;

                & > li:last-child {
                    margin-bottom: 0;
                }
            }
        }
    }
}
```

