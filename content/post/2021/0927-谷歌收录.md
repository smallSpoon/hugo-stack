---
title: Hugo | 增加Google Search Console及其他修改
date: 2021-09-27T22:55:08+08:00
lastmod: 2021-09-27T22:55:08+08:00
description: 我这种行为像什么呢，“平凡麻瓜40小时爆改样板间，闻者也，落泪，见者也，伤心。”
toc: true
tags:
  - Hugo
categories:
  - 麻瓜快速念咒互助小组
image: 
math: 
license: 
hidden: false
comments: true
slug: a08f1963
---

之前那篇太长了，转移阵地到这篇来

​	

## Google Search Console

参考了[为 Hugo 配置 Google Analytics](https://immwind.com/google-analytics-for-hugo/)这篇文章来配置[Google Search Console]()，但前前后后试了好几遍都不能通过DNS验证，最后只能选择通过网址前缀来进行添加，用HTML 标记验证。

遇到了站点地图无法读取的情况，参考[Search Console帮助](https://support.google.com/webmasters/thread/101172591/%E6%98%BE%E7%A4%BA%E6%97%A0%E6%B3%95%E8%AF%BB%E5%8F%96%E6%AD%A4%E7%AB%99%E7%82%B9%E5%9C%B0%E5%9B%BE?hl=zh-Hans)，显示站长工具有一定延迟，过几天再看看。

另外，写在这儿好了，在装Google Analytics时出了点问题，无论如何无法屏蔽本地的计数——后来发现是因为Stack模板中预先写了一条

```
{{- template "_internal/google_analytics.html" . -}}
```

而我的文件名叫做`google_analytics_async.html`…………至于不小心删了`{{- partial "head/custom.html" . -}}`导致惊慌失措地找了半个点为什么字体失效这件事咱们当它没发生过，好吗？

​	

### 解决DNS通过验证

过了一天Google还是没有读出来我的TXT记录，我觉得这不对劲，开始研究。

首先读了排解 [TXT 記錄問題](https://support.google.com/a/answer/2716888#zippy=%2C%E4%BD%BF%E7%94%A8%E5%85%8D%E8%B2%BB%E7%B6%B2%E8%B7%AF%E6%9C%8D%E5%8B%99%E6%9F%A5%E8%A9%A2-txt-%E8%A8%98%E9%8C%84%2C%E8%AE%8A%E6%9B%B4-hostname-%E6%AC%84%E4%BD%8D%E4%B8%AD%E7%9A%84%E9%A0%85%E7%9B%AE)，文章中提到DNS变更最多可能需要72小时才能生效，这明显和我的情况不符——最早的TXT记录已经加了最少半个月，无论如何也应该生效了。

文章中同时提到，可以利用[DNS查询工具](https://toolbox.googleapps.com/apps/dig/)来查询网址的DNS生效情况，输入后发现并没有显示TXT记录，验证了TXT记录确实没有生效——复查了添加是否出错等一系列错误可能之后，我觉得问题应该不在于填写TXT值的姿势有问题——更可能是某些魔法事故，于是我搜索了“TXT值验证失败”，并在[域名授权验证配置推送失败](https://help.aliyun.com/knowledge_detail/48058.html)里找到了这么一句话：

> **说明**：如果您的域名解析中存在CNAME记录，请暂时去掉该CNAME记录，否则将无法通过域名授权验证。在数字证书签发后，您可删除添加的TXT记录，并重新添加CNAME记录。如果CNAME记录无法删除，请通过文件验证方式完成域名授权验证。

把CNAME改成A记录之后十分钟左右，Google Search Console迅速地通过了我的DNS验证申请。

……谢谢你，阿里云

​	



## 自动更新文章最后修改时间

想要这个功能主要是因为主题里有在篇末显示最后更新时间的功能，所以我开始捣鼓了（你

研究了在Front Matter里加lastmod参数的种种可能，最后举手投降，参考了[自动添加博客页面更新日期](https://blog.yfei.page/cn/2021/03/lastmod-hugo/)，在`config.yaml`里写

```
frontmatter:
  lastmod: [":fileModTime", "lastmod"]
```

本来想加上`":git"`的，意思是读取git推送的时间，但是推上去好像时区不太对，目前还没有解决这个问题……

​	

